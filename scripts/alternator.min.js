// @license This script is designed to help archival institutions (such as museums) collect alt text from enthusiastic users. https://github.com/harvardartmuseums/alternator
!function(){var t={url:document.querySelector("meta[name='alternator-url']").getAttribute("content"),contact:document.querySelector("meta[name='alternator-contact']").getAttribute("content"),id:document.querySelector("meta[name='alternator-id']").getAttribute("content"),guide:document.querySelector("meta[name='alternator-guide']").getAttribute("content"),target:document.querySelector("meta[name='alternator-target']").getAttribute("content"),path:document.querySelector("meta[name='alternator-path']").getAttribute("content"),container:document.querySelector("meta[name='alternator-container']").getAttribute("content")},e=null;switch(t.target){case"sm":e="https://api.sheetmonkey.io/form/"+t.path;break;case"gs":e=`https://script.google.com/macros/s/${t.path}/exec`;break;default:e=null}var i=function(t){"block"===window.getComputedStyle(t).display?(t.style.display="none",a("stop")):(t.style.display="block",a())},o=t.container?document.getElementById(t.container):document.body,n=t.container?"position:absolute; left: 50%; transform: translateX(-50%); top: -32px;":"position:fixed; bottom: 0; right: 20px;",n=(t.container&&(o.style.position="relative"),`<button role="button" style="transition: all .3s; ${n} z-index: 500; font-size:16px; background-color: #c43422; border: 1px solid #c43422; color: white; padding: 3px 10px; text-decoration: none;
  cursor: pointer;" onMouseOver="this.style.backgroundColor='#30892d',this.style.border='1px solid #30892d'" onMouseOut="this.style.color='#fff',this.style.backgroundColor='#c43422',this.style.border='1px solid #c43422'" id="alternator-toggle">+ ALT</button>`),r=`<div style="transition: all .5s ease-in-out; position: fixed; z-index:600; left: 0; bottom: 0; width: 100%; background-color: #d4d4d7; text-align: center; font-family: arial; display:none;" class="place-content-center" id="alternator-form" >
  <div style="width: 90%; margin: 0 auto; display:block; overflow:hidden;">
  <button onclick="dismiss(this);" id="alternator-close" style="background-color: black; border: none; color: white; padding: 12px 32px; text-decoration: none; cursor: pointer; display:table; float:right; margin: 20px 0 20px 20px; font-size:16px;">close</button>
  <a href="${t.guide}" target="_blank" style=" background-color: #444444; border: none; color: white; padding: 12px 32px; text-decoration: none; cursor: pointer; display:table; float:right; margin: 20px 0; font-size:16px;">Institutional Style Guide</a>
  </div>
  <form action="${e}" method="post" style="padding:20px 0; font-family: arial; width: 90%; margin: 0 auto;">
    <!-- Put HTML input fields in here and see how they fill up your sheet -->
    <textarea rows="3" placeholder="Alt text" name="alt" style="width:100%; font-family: arial; font-size:16px; margin-bottom: 10px; padding:10px; box-sizing: border-box;" required /></textarea>
    <textarea rows="3" placeholder="Description text" name="description" style="width:100%; font-family: arial; font-size:16px; margin-bottom: 10px; padding:10px; box-sizing: border-box;" /></textarea>
    <input type="hidden" name="Created" value="x-sheetmonkey-current-date-time" />
    <input type="hidden" name="id" value="${t.id}" />
    <input type="hidden" name="url" value="${t.url}" />
    <input type="hidden" name="contact" value="${t.contact}" />
    <div>
    <input placeholder="Your Email" type="text" name="email" style="font-family: arial; font-size:16px; padding:10px;" />
    <input style="font-size:16px; background-color: black; border: none; color: white; padding: 12px 32px; text-decoration: none; margin: 4px 2px;
cursor: pointer;" type="submit" value="SUBMIT" />
    </div>
  </form>
  </div>
  `,o=(o.insertAdjacentHTML("afterbegin",n),document.getElementById("alternator-toggle"));document.body.insertAdjacentHTML("afterend",r);const l=document.getElementById("alternator-form");function a(e){var o=0,n="up",r="up";let a=l.offsetHeight;document.getElementById("alternator-close").addEventListener("click",function(t){i(l)}),window.onscroll=function(){var t;"stop"!==e&&(0<(t=document.documentElement.scrollTop||document.body.scrollTop)&&o<=t?(o=t,n!=(r="down")&&(n=r,l.style.bottom=85-a+"px")):(o=t,n!=(r="up")&&(n=r,l.style.bottom="0")))}}o.addEventListener("click",function(t){i(l)})}();